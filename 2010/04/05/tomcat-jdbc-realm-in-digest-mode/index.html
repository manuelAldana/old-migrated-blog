<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head profile="http://gmpg.org/xfn/11">

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	
	<title>Manuel Aldana &#8212  Tomcat JDBC-Realm in digest mode</title>
	
	<meta name="generator" content="WordPress 2.9.2" /> <!-- leave this for stats -->
  <link rel="shortcut icon" href="../../../../favicon.ico"/>	
	<link rel="stylesheet" href="../../../../wp-content/themes/cutlineAldana/style.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="../../../../wp-content/themes/cutlineAldana/custom_css/custom.css" type="text/css" media="screen" />
	<!--[if lte IE 7]>
	<link rel="stylesheet" type="text/css" href="http://www.aldana-online.de/wp-content/themes/cutlineAldana/ie7.css" media="screen" />
	<![endif]-->
	<!--[if lte IE 6]>
	<link rel="stylesheet" type="text/css" href="http://www.aldana-online.de/wp-content/themes/cutlineAldana/ie6.css" media="screen" />
	<![endif]-->
	<link rel="alternate" type="application/rss+xml" title="Manuel Aldana RSS Feed" href="../../../../feed/index.html" />
	<link rel="pingback" href="../../../../xmlrpc.php" />
	<meta name="google-site-verification" content="L4vY5UHsSR0hLG7CXwSvTMmUHiV0P59pw6tX8xhm_kM" />

	<link rel="stylesheet" href="../../../../wp-content/plugins/codesnippet/codesnippet.css" type="text/css" />
<style type="text/css">
.codesnip-container  {border:1px solid #ccc; background:#eee; padding: 5px;margin:10px;}
</style>
<link rel="alternate" type="application/rss+xml" title="Manuel Aldana &raquo; Tomcat JDBC-Realm in digest mode Comments Feed" href="feed/index.html" />
<script type='text/javascript' src='../../../../wp-includes/js/jquery/jquery.js@ver=1.3.2'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../xmlrpc.php@rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../../wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Manuel Aldana' href='../../../../index.html' />
<link rel='start' title='Wordpress setup' href='../../../../2008/01/30/wordpress-setup/index.html' />
<link rel='prev' title='Extending source-code syntax highlighting' href='../../../../2009/12/13/extending-source-code-syntax-highlighting/index.html' />
<link rel='next' title='Codebase size implications on Software development' href='../../../05/09/process-implications-of-metric-lines-of-code-loc/index.html' />
<meta name="generator" content="WordPress 2.9.2" />
<link rel='canonical' href='index.html' />
<link rel="stylesheet" href="../../../../wp-content/plugins/digg-digg/css/diggdigg-style.css@ver=4.2.css" type="text/css" media="screen" /></head>

<body class="custom">
<div id="container">

<div id="header_text_big">
SOFTWARE ENGINEERING blog &amp; .lessons_learned</div>
<div id="header_text_normal">
manuel aldana
</div>
<div id="header_img">		
		<a href="../../../../index.html"><img src="../../../../wp-content/themes/cutlineAldana/images/blogLogoAldana.jpg" alt="Manuel Aldana" title="Manuel Aldana" /></a>		
</div>

	<ul id="nav">
		<li class="rss"><a href="../../../../feed/index.html">RSS</a></li>
	</ul>

	

	<div id="content_box">
	
		<div id="l_sidebar">
	<ul class="sidebar_list">
				<li id="recent-posts-3" class="widget widget_recent_entries">		<h2 class="widgettitle">Last entries</h2>
		<ul>
				<li><a href="../../../../2018/05/30/notes-on-dsvgo-gdpr-regarding-comment-function/index.html" title="Notes on DSVGO / GDPR regarding comment function">Notes on DSVGO / GDPR regarding comment function </a></li>
				<li><a href="../../../../2012/01/26/the-evil-path-of-mobile-apps-vs-webstandards/index.html" title="The evil path of Mobile-Apps (vs. Webstandards)&#8230;">The evil path of Mobile-Apps (vs. Webstandards)&#8230; </a></li>
				<li><a href="../../../../2011/09/30/complexity-drivers-of-software-systems/index.html" title="Complexity drivers of Software-Systems">Complexity drivers of Software-Systems </a></li>
				<li><a href="../../../../2011/07/03/accessing-rrdtool-files-data-with-java/index.html" title="Accessing rrdtool-files Data with Java / Scala">Accessing rrdtool-files Data with Java / Scala </a></li>
				<li><a href="../../../../2011/05/15/embracing-failure-softwareapproaches/index.html" title="&#8216;Embrace Failure&#8217; approaches in Software Development">&#8216;Embrace Failure&#8217; approaches in Software Development </a></li>
				<li><a href="../../../../2011/03/13/top-tools-for-logging-analysis-cli-based/index.html" title="Top-Tools for Log-Analysis (CLI based)">Top-Tools for Log-Analysis (CLI based) </a></li>
				</ul>
		</li>
<li id="flexi-pages" class="widget flexipages_widget"><h2 class="widgettitle">About me</h2>
<ul>
<li class="page_item page-item-2"><a href="../../../../about/index.html" title="About me/Contact">About me/Contact</a></li>
<li class="page_item page-item-95"><a href="../../../../it-skills/index.html" title="IT-Skills">IT-Skills</a></li>
<li class="page_item page-item-115"><a href="../../../../my-bookshelfbook-highlights/index.html" title="Book Highlights">Book Highlights</a></li>
<li class="page_item page-item-14"><a href="../../../../open-source/index.html" title="Open Source">Open Source</a></li>
<li class="page_item page-item-19"><a href="../../../../university/index.html" title="University">University</a></li>
<li class="page_item page-item-21"><a href="../../../../leisure/index.html" title="Hobbies">Hobbies</a></li>
<li class="page_item page-item-6"><a href="../../../../camphill/index.html" title="Camphill">Camphill</a></li>
</ul>
</li>
<li id="categories-1" class="widget widget_categories"><h2 class="widgettitle">Blog Categories</h2>
		<ul>
	<li class="cat-item cat-item-4"><a href="../../../../category/software-engineering/continous-integration/index.html" title="View all posts filed under Continous Integration">Continous Integration</a> (7)
</li>
	<li class="cat-item cat-item-3"><a href="../../../../category/software-engineering/index.html" title="View all posts filed under Software Engineering">Software Engineering</a> (22)
</li>
	<li class="cat-item cat-item-6"><a href="../../../../category/software-engineering/software-maintenance/index.html" title="View all posts filed under Software Maintenance">Software Maintenance</a> (5)
</li>
	<li class="cat-item cat-item-20"><a href="../../../../category/software-engineering/technologies-tools/index.html" title="View all posts filed under Technologies/Tools">Technologies/Tools</a> (10)
</li>
	<li class="cat-item cat-item-1"><a href="../../../../category/uncategorized/index.html" title="View all posts filed under Uncategorized">Uncategorized</a> (5)
</li>
		</ul>
</li>
<li id="linkcat-2" class="widget widget_links"><h2 class="widgettitle">Important SE Links</h2>

	<ul class='xoxo blogroll'>
<li><a href="http://www.artima.com/weblogs/index.jsp?blogger=beckel" title="well known and pragmatic " target="_blank">Bruce Eckel</a></li>
<li><a href="http://www.codinghorror.com/blog/" target="_blank">Coding Horror</a></li>
<li><a href="http://www.dzone.com/links/index.html" target="_blank">DZone</a></li>
<li><a href="http://www.infoq.com/" target="_blank">InfoQ</a></li>
<li><a href="http://www.joelonsoftware.com/" target="_blank">Joel on Software</a></li>
<li><a href="http://martinfowler.com/bliki/" title="one, of the first pushing refactoring to public" target="_blank">Martin Fowler</a></li>
<li><a href="http://www.se-radio.net/" title="very interesting podcasts from different experts all around software engineering" target="_blank">Software Engineering Radio</a></li>
<li><a href="http://theserverside.com" title="all about enterprise applications (especially with java)" target="_blank">TheServerSide</a></li>

	</ul>
</li>

<li id="search-2" class="widget widget_search"><form method="get" id="search_form" action="../../../../index.html">
	<input type="text" class="search_input" value="To search, type and hit enter" name="s" id="s" onfocus="if (this.value == 'To search, type and hit enter') {this.value = '';}" onblur="if (this.value == '') {this.value = 'To search, type and hit enter';}" />
	<input type="hidden" id="searchsubmit" value="Search" />
</form>
</li>
	</ul>
</div>		
		<div id="content" class="posts">
			
				
<div class="newer_older">		
	<div class="newer">&lt; <a href="../../../05/09/process-implications-of-metric-lines-of-code-loc/index.html">Codebase size implications on Software development</a> </div>
	<div class="older"> <a href="../../../../2009/12/13/extending-source-code-syntax-highlighting/index.html">Extending source-code syntax highlighting</a> &gt; </div>
</div>
					
			<h4>April 5th, 2010<!-- by manuel aldana --> &middot; <a href="index.html#comments">No Comments</a></h4>
			<h2>Tomcat JDBC-Realm in digest mode</h2>			
			
			<div class="entry">
				<div class='dd_post_share dd_post_share_left'><div class='dd_buttons'><div class='dd_button'><iframe src='http://widgets.dzone.com/links/widgets/zoneit.html?url=http://www.aldana-online.de/2010/04/05/tomcat-jdbc-realm-in-digest-mode/&amp;title=Tomcat+JDBC-Realm+in+digest+mode&amp;t=1' height='68' width='52' frameborder='0' scrolling='no'></iframe></div></div></div><p>Though the <a href="http://tomcat.apache.org/tomcat-6.0-doc/realm-howto.html" target="_blank">tomcat-docs</a> gives most information, there are some pitfalls when using tomcats facilities for HTTP Auth in Digest mode including hashed passwords. Following is a list to avoid them (tested on tomcat 6.0.x).</p>
<h3>JDBC Driver to classpath</h3>
<p>Tomcat realm handling is container internal, therefore it is not enough to have jdbc-driver (e.g. mysql-connector-java-5.1.6.jar) in your application classpath. You have to explicit add it to the container classpath (e.g. TOMCAT_HOME/lib).</p>
<h3>Configuration Snippets</h3>
<p>Tomcat container config, which can appear as nested element inside &lt;Engine&gt;, &lt;Host&gt; or &lt;Context&gt; (e.g. TOMCAT_HOME/conf/context.xml):</p>
<pre>
<div class="codesnip-container" >
<div class="codesnip">...
<span class="sc3"><span class="coMULTI">&lt;!-- database connection settings + enabling hashed passwords (MD5 sum style) --&gt;</span></span>
<span class="sc3"><span class="re1">&lt;Realm</span>
&nbsp;<span class="re0">className</span>=<span class="st0">"org.apache.catalina.realm.JDBCRealm"</span>
&nbsp;<span class="re0">digest</span>=<span class="st0">"MD5"</span>
&nbsp;<span class="re0">driverName</span>=<span class="st0">"com.mysql.jdbc.Driver"</span>
&nbsp;<span class="re0">connectionURL</span>=<span class="st0">"jdbcURL"</span>
&nbsp;<span class="re0">connectionName</span>=<span class="st0">"dbUser"</span>
&nbsp;<span class="re0">connectionPassword</span>=<span class="st0">"dbPwd"</span>
&nbsp;<span class="re0">userRoleTable</span>=<span class="st0">"role_table"</span>
&nbsp;<span class="re0">userTable</span>=<span class="st0">"user_table"</span>
&nbsp;<span class="re0">userNameCol</span>=<span class="st0">"dbuser_column"</span>
&nbsp;<span class="re0">userCredCol</span>=<span class="st0">"dbpwd_column"</span>
&nbsp;<span class="re0">roleNameCol</span>=<span class="st0">"role_column"</span><span class="re2">/&gt;</span></span>
...</div>
</div>
</pre>
<p>Webapplication web.xml:</p>
<pre>
<div class="codesnip-container" >
<div class="codesnip"><span class="sc3"><span class="re1">&lt;web</span>-app<span class="re2">&gt;</span></span>
...
&nbsp;<span class="sc3"><span class="re1">&lt;security</span>-constraint<span class="re2">&gt;</span></span>
&nbsp; &nbsp;<span class="sc3"><span class="re1">&lt;web</span>-resource-collection<span class="re2">&gt;</span></span>
&nbsp; &nbsp; &nbsp;<span class="sc3"><span class="re1">&lt;web</span>-resource-name<span class="re2">&gt;</span></span>Secure area<span class="sc3"><span class="re1">&lt;/web</span>-resource-name<span class="re2">&gt;</span></span>
&nbsp; &nbsp; &nbsp;<span class="sc3"><span class="re1">&lt;url</span>-pattern<span class="re2">&gt;</span></span>/*<span class="sc3"><span class="re1">&lt;/url</span>-pattern<span class="re2">&gt;</span></span>
&nbsp; &nbsp;<span class="sc3"><span class="re1">&lt;/web</span>-resource-collection<span class="re2">&gt;</span></span>
&nbsp; &nbsp;<span class="sc3"><span class="re1">&lt;auth</span>-constraint<span class="re2">&gt;</span></span>
&nbsp; &nbsp; &nbsp;<span class="sc3"><span class="re1">&lt;role</span>-name<span class="re2">&gt;</span></span>admin<span class="sc3"><span class="re1">&lt;/role</span>-name<span class="re2">&gt;</span></span>
&nbsp; &nbsp;<span class="sc3"><span class="re1">&lt;/auth</span>-constraint<span class="re2">&gt;</span></span>
&nbsp;<span class="sc3"><span class="re1">&lt;/security</span>-constraint<span class="re2">&gt;</span></span>

&nbsp;<span class="sc3"><span class="re1">&lt;login</span>-config<span class="re2">&gt;</span></span>
&nbsp; &nbsp;<span class="sc3"><span class="coMULTI">&lt;!-- enabling HTTP Auth digest mode --&gt;</span></span>
&nbsp; &nbsp;<span class="sc3"><span class="re1">&lt;auth</span>-method<span class="re2">&gt;</span></span>DIGEST<span class="sc3"><span class="re1">&lt;/auth</span>-method<span class="re2">&gt;</span></span>
&nbsp; &nbsp;<span class="sc3"><span class="re1">&lt;realm</span>-name<span class="re2">&gt;</span></span>your-realm<span class="sc3"><span class="re1">&lt;/realm</span>-name<span class="re2">&gt;</span></span>
&nbsp;<span class="sc3"><span class="re1">&lt;/login</span>-config<span class="re2">&gt;</span></span>

&nbsp;<span class="sc3"><span class="coMULTI">&lt;!-- roles must be defined to be used in security-constraint --&gt;</span></span>
&nbsp;<span class="sc3"><span class="re1">&lt;security</span>-role<span class="re2">&gt;</span></span>
&nbsp; &nbsp;<span class="sc3"><span class="re1">&lt;description<span class="re2">&gt;</span></span></span>Role sample<span class="sc3"><span class="re1">&lt;/description<span class="re2">&gt;</span></span></span>
&nbsp; &nbsp;<span class="sc3"><span class="re1">&lt;role</span>-name<span class="re2">&gt;</span></span>admin<span class="sc3"><span class="re1">&lt;/role</span>-name<span class="re2">&gt;</span></span>
&nbsp;<span class="sc3"><span class="re1">&lt;/security</span>-role<span class="re2">&gt;</span></span>
...
<span class="sc3"><span class="re1">&lt;/web</span>-app<span class="re2">&gt;</span></span></div>
</div>
</pre>
<h3>Password patterns</h3>
<p>For HTTP Auth Digest tomcat expects a special cleartext pattern for the hashed password entry inside the database. Unfortunately the cleartext snippet is different from the one from Http Auth Basic (this took me some time to find out&#8230;).</p>
<p>Bash CLI samples for HTTP Auth password hashing (md5sum):</p>
<pre>
<div class="codesnip-container" ># Basic style (only the password without user or realm info is hashed)
echo -n password | md5sum
# Digest style (<b>'your-realm'</b> is entry from web.xml-&gt;login-config-&gt;realm-name)
echo -n username:your-realm:password | md5sum</div>
</pre>
<h3>Migration HTTP Auth Basic to Digest</h3>
<p>As you saw above tomcats Auth Basic and Digest cleartext password patterns are different. Therefore just switching the entry of <b>web.xml-&gt;login-config-&gt;auth-method</b> from <b>&#8216;BASIC&#8217;</b> to <b>&#8216;DIGEST&#8217;</b> wouldn&#8217;t suffice. I recommend to completely create a new database column (e.g. passwords_digest) so the separation and transition-path between Basic and Digest style is more clear. In case you hashed the Basic passwords already further more you have to reset the user passwords (the nature of good hashes are that you practically cannot map back to cleartext).</p>
<!-- Social Buttons Shared Counts Generated by Digg Digg plugin v4.2, 
    Author : Yong Mook Kim
    Website : http://www.mkyong.com/blog/digg-digg-wordpress-plugin/ -->							</div>
			<p class="tagged"><strong>Tags:</strong> <a href="../../../../category/software-engineering/technologies-tools/index.html" title="View all posts in Technologies/Tools" rel="category tag">Technologies/Tools</a></p>
		
			<div class="newer_older">		
	<div class="newer">&lt; <a href="../../../05/09/process-implications-of-metric-lines-of-code-loc/index.html">Codebase size implications on Software development</a> </div>
	<div class="older"> <a href="../../../../2009/12/13/extending-source-code-syntax-highlighting/index.html">Extending source-code syntax highlighting</a> &gt; </div>
</div>
	
	
			
<!-- You can start editing here. -->


<div id="comments">

	<h3 class="comments_headers">0 responses</h3>
	
	<ul id="comment_list">

	
	<!-- Comment Form -->
		
			
			<p class="unstyled">You must <a href="../../../../wp-login.php@redirect_to=http%253A%252F%252Fwww.aldana-online.de%252F2010%252F04%252F05%252Ftomcat-jdbc-realm-in-digest-mode%252F.html">log in</a> to post a comment.</p>
	
		
</div> <!-- Close #comments container -->
<div class="clear flat"></div>
			
				
		</div>
		

			
	</div>

	<div id="footer">
	
  
  <p>	 
    &copy; 2007&ndash;2010 Software Engineering blog &amp; .more  &mdash; <a href="../../../../sitemap.xml">Sitemap</a> &mdash; Manuel Aldana
		      
  </p>
  <p>
			<a href="http://www.mozilla.org/products/firefox/" target="_blank" title="Get Firefox"><img src="../../../../getfirefox_small.png"  border="0" alt="Get Firefox" /></a>  
</p>
  
	</div>
</div>

</body>
</html>
