<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head profile="http://gmpg.org/xfn/11">

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	
	<title>Manuel Aldana &#8212  Top-Tools for Log-Analysis (CLI based) </title>
	
	<meta name="generator" content="WordPress 2.9.2" /> <!-- leave this for stats -->
  <link rel="shortcut icon" href="../../../../favicon.ico"/>	
	<link rel="stylesheet" href="../../../../wp-content/themes/cutlineAldana/style.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="../../../../wp-content/themes/cutlineAldana/custom_css/custom.css" type="text/css" media="screen" />
	<!--[if lte IE 7]>
	<link rel="stylesheet" type="text/css" href="http://www.aldana-online.de/wp-content/themes/cutlineAldana/ie7.css" media="screen" />
	<![endif]-->
	<!--[if lte IE 6]>
	<link rel="stylesheet" type="text/css" href="http://www.aldana-online.de/wp-content/themes/cutlineAldana/ie6.css" media="screen" />
	<![endif]-->
	<link rel="alternate" type="application/rss+xml" title="Manuel Aldana RSS Feed" href="../../../../feed/index.html" />
	<link rel="pingback" href="../../../../xmlrpc.php" />
	<meta name="google-site-verification" content="L4vY5UHsSR0hLG7CXwSvTMmUHiV0P59pw6tX8xhm_kM" />

	<link rel="stylesheet" href="../../../../wp-content/plugins/codesnippet/codesnippet.css" type="text/css" />
<style type="text/css">
.codesnip-container  {border:1px solid #ccc; background:#eee; padding: 5px;margin:10px;}
</style>
<link rel="alternate" type="application/rss+xml" title="Manuel Aldana &raquo; Top-Tools for Log-Analysis (CLI based) Comments Feed" href="feed/index.html" />
<script type='text/javascript' src='../../../../wp-includes/js/jquery/jquery.js@ver=1.3.2'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../xmlrpc.php@rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../../wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Manuel Aldana' href='../../../../index.html' />
<link rel='start' title='Wordpress setup' href='../../../../2008/01/30/wordpress-setup/index.html' />
<link rel='prev' title='Unit-Testing: Situations when NOT to do it' href='../../../02/06/major-unit-testing-pitfalls-and-anti-patterns/index.html' />
<link rel='next' title='&#8216;Embrace Failure&#8217; approaches in Software Development' href='../../../05/15/embracing-failure-softwareapproaches/index.html' />
<meta name="generator" content="WordPress 2.9.2" />
<link rel='canonical' href='index.html' />
<link rel="stylesheet" href="../../../../wp-content/plugins/digg-digg/css/diggdigg-style.css@ver=4.2.css" type="text/css" media="screen" /></head>

<body class="custom">
<div id="container">

<div id="header_text_big">
SOFTWARE ENGINEERING blog &amp; .lessons_learned</div>
<div id="header_text_normal">
manuel aldana
</div>
<div id="header_img">		
		<a href="../../../../index.html"><img src="../../../../wp-content/themes/cutlineAldana/images/blogLogoAldana.jpg" alt="Manuel Aldana" title="Manuel Aldana" /></a>		
</div>

	<ul id="nav">
		<li class="rss"><a href="../../../../feed/index.html">RSS</a></li>
	</ul>

	

	<div id="content_box">
	
		<div id="l_sidebar">
	<ul class="sidebar_list">
				<li id="recent-posts-3" class="widget widget_recent_entries">		<h2 class="widgettitle">Last entries</h2>
		<ul>
				<li><a href="../../../../2018/05/30/notes-on-dsvgo-gdpr-regarding-comment-function/index.html" title="Notes on DSVGO / GDPR regarding comment function">Notes on DSVGO / GDPR regarding comment function </a></li>
				<li><a href="../../../../2012/01/26/the-evil-path-of-mobile-apps-vs-webstandards/index.html" title="The evil path of Mobile-Apps (vs. Webstandards)&#8230;">The evil path of Mobile-Apps (vs. Webstandards)&#8230; </a></li>
				<li><a href="../../../09/30/complexity-drivers-of-software-systems/index.html" title="Complexity drivers of Software-Systems">Complexity drivers of Software-Systems </a></li>
				<li><a href="../../../07/03/accessing-rrdtool-files-data-with-java/index.html" title="Accessing rrdtool-files Data with Java / Scala">Accessing rrdtool-files Data with Java / Scala </a></li>
				<li><a href="../../../05/15/embracing-failure-softwareapproaches/index.html" title="&#8216;Embrace Failure&#8217; approaches in Software Development">&#8216;Embrace Failure&#8217; approaches in Software Development </a></li>
				<li><a href="index.html" title="Top-Tools for Log-Analysis (CLI based)">Top-Tools for Log-Analysis (CLI based) </a></li>
				</ul>
		</li>
<li id="flexi-pages" class="widget flexipages_widget"><h2 class="widgettitle">About me</h2>
<ul>
<li class="page_item page-item-2"><a href="../../../../about/index.html" title="About me/Contact">About me/Contact</a></li>
<li class="page_item page-item-95"><a href="../../../../it-skills/index.html" title="IT-Skills">IT-Skills</a></li>
<li class="page_item page-item-115"><a href="../../../../my-bookshelfbook-highlights/index.html" title="Book Highlights">Book Highlights</a></li>
<li class="page_item page-item-14"><a href="../../../../open-source/index.html" title="Open Source">Open Source</a></li>
<li class="page_item page-item-19"><a href="../../../../university/index.html" title="University">University</a></li>
<li class="page_item page-item-21"><a href="../../../../leisure/index.html" title="Hobbies">Hobbies</a></li>
<li class="page_item page-item-6"><a href="../../../../camphill/index.html" title="Camphill">Camphill</a></li>
</ul>
</li>
<li id="categories-1" class="widget widget_categories"><h2 class="widgettitle">Blog Categories</h2>
		<ul>
	<li class="cat-item cat-item-4"><a href="../../../../category/software-engineering/continous-integration/index.html" title="View all posts filed under Continous Integration">Continous Integration</a> (7)
</li>
	<li class="cat-item cat-item-3"><a href="../../../../category/software-engineering/index.html" title="View all posts filed under Software Engineering">Software Engineering</a> (22)
</li>
	<li class="cat-item cat-item-6"><a href="../../../../category/software-engineering/software-maintenance/index.html" title="View all posts filed under Software Maintenance">Software Maintenance</a> (5)
</li>
	<li class="cat-item cat-item-20"><a href="../../../../category/software-engineering/technologies-tools/index.html" title="View all posts filed under Technologies/Tools">Technologies/Tools</a> (10)
</li>
	<li class="cat-item cat-item-1"><a href="../../../../category/uncategorized/index.html" title="View all posts filed under Uncategorized">Uncategorized</a> (5)
</li>
		</ul>
</li>
<li id="linkcat-2" class="widget widget_links"><h2 class="widgettitle">Important SE Links</h2>

	<ul class='xoxo blogroll'>
<li><a href="http://www.artima.com/weblogs/index.jsp?blogger=beckel" title="well known and pragmatic " target="_blank">Bruce Eckel</a></li>
<li><a href="http://www.codinghorror.com/blog/" target="_blank">Coding Horror</a></li>
<li><a href="http://www.dzone.com/links/index.html" target="_blank">DZone</a></li>
<li><a href="http://www.infoq.com/" target="_blank">InfoQ</a></li>
<li><a href="http://www.joelonsoftware.com/" target="_blank">Joel on Software</a></li>
<li><a href="http://martinfowler.com/bliki/" title="one, of the first pushing refactoring to public" target="_blank">Martin Fowler</a></li>
<li><a href="http://www.se-radio.net/" title="very interesting podcasts from different experts all around software engineering" target="_blank">Software Engineering Radio</a></li>
<li><a href="http://theserverside.com" title="all about enterprise applications (especially with java)" target="_blank">TheServerSide</a></li>

	</ul>
</li>

<li id="search-2" class="widget widget_search"><form method="get" id="search_form" action="../../../../index.html">
	<input type="text" class="search_input" value="To search, type and hit enter" name="s" id="s" onfocus="if (this.value == 'To search, type and hit enter') {this.value = '';}" onblur="if (this.value == '') {this.value = 'To search, type and hit enter';}" />
	<input type="hidden" id="searchsubmit" value="Search" />
</form>
</li>
	</ul>
</div>		
		<div id="content" class="posts">
			
				
<div class="newer_older">		
	<div class="newer">&lt; <a href="../../../05/15/embracing-failure-softwareapproaches/index.html">&#8216;Embrace Failure&#8217; approaches in Software Development</a> </div>
	<div class="older"> <a href="../../../02/06/major-unit-testing-pitfalls-and-anti-patterns/index.html">Unit-Testing: Situations when NOT to do it</a> &gt; </div>
</div>
					
			<h4>March 13th, 2011<!-- by manuel aldana --> &middot; <a href="index.html#comments">No Comments</a></h4>
			<h2>Top-Tools for Log-Analysis (CLI based)</h2>			
			
			<div class="entry">
				<div class='dd_post_share dd_post_share_left'><div class='dd_buttons'><div class='dd_button'><iframe src='http://widgets.dzone.com/links/widgets/zoneit.html?url=http://www.aldana-online.de/2011/03/13/top-tools-for-logging-analysis-cli-based/&amp;title=Top-Tools+for+Log-Analysis+%28CLI+based%29+&amp;t=1' height='68' width='52' frameborder='0' scrolling='no'></iframe></div></div></div><p>After all the years it is still remarkable how powerful plain text is for software development (human readability, advanced SCM tools, expressiveness, no GUI necessary, etc.). This applies also on logging, where plain text makes a very nice source for doing adhoc analysis. Following samples show how bash, its interprocess-communication piping and the usual suspect tools (awk, grep, sed, tr, etc.) give you great control when doing analysis.</p>
<h3>Format</h3>
<p>Logs should have a standard format, so analysis can rely on structured output and operate on it, programs are less flexible as humans and need strict patterns. Most often such logs are line-based and white-space separate based. Fortunately most logging frameworks make this a non brainer (e.g apache log-format settings, log4j).</p>
<p>Usual log-pattern, rows/lines form single datasets and are most often ordered by time, because they are appended by the software over time, they often contain also timestamps. The lines most often are independant of each other, but for each line data needs to follow strict order (apart from loose text like error-messages or furhter stack traces):</p>
<div class="codesnip-container" >
<div class="codesnip">dataset1<span class="br0">&#40;</span>line1<span class="br0">&#41;</span>: data1 data2 data3<br />
dataset2<span class="br0">&#40;</span>line2<span class="br0">&#41;</span>: data1 data2 data3<br />
dataset3<span class="br0">&#40;</span>line3<span class="br0">&#41;</span>: data1 data2 data3<br />
&#8230;</div>
</div>
<p>To better understand examples I refer to apache-logging pattern (HTTP based web-traffic). Still all the example adhoc queries can be applied to all other log-output target/formats:</p>
<div class="codesnip-container" >&#8230;<br />
127.0.0.1 &#8211; - [29/Feb/2011:13:58:50 +0100] &#8220;GET /api/image/status/ok HTTP/1.1&#8243; 200 476 &#8220;-&#8221; &#8220;Jakarta Commons-HttpClient/3.1&#8243;<br />
&#8230;</div>
<h3>Log analysis in Action</h3>
<p>Quick overview for further analysis steps:</p>
<div class="codesnip-container" >
<div class="codesnip"><span class="co1"># using &#8216;less&#8217; so reading longer output is easier</span><br />
grep <span class="st0">&#8221; 200 &#8220;</span> log-file | less</p>
<p><span class="co1"># only direct stuff to &#8216;less&#8217; which is of interest, in this case show relative URI path (7th position)</span><br />
grep <span class="st0">&#8221; 200 &#8220;</span> log-file | awk <span class="st0">&#8216;{print $7}&#8217;</span> | less</p>
<p><span class="co1"># plain text is good candidate for compressing therefore on production</span><br />
<span class="co1"># environment files are often zipped to save disk space, therefore use zgrep</span><br />
zgrep * | awk <span class="st0">&#8216;{print $7}&#8217;</span> | less</div>
</div>
<p>Counts:</p>
<div class="codesnip-container" >
<div class="codesnip"><span class="co1"># count of HTTP calls which had 404 status</span><br />
grep -c <span class="st0">&#8221; 404 &#8220;</span> log-file<br />
<span class="co1"># more verbose equivalent</span><br />
cat log-file | grep <span class="st0">&#8221; 404 &#8220;</span> | wc -l</p>
<p><span class="co1"># count of all other but 404 HTTP status (inverse grep)</span><br />
grep -v -c <span class="st0">&#8221; 404 &#8220;</span> log-file</p>
<p><span class="co1"># piping (filtering step-by-step)</span><br />
<span class="co1"># showing number of failed (non 201 status) image uploads (POST)</span><br />
cat log-file | grep -v <span class="st0">&#8221; 201 &#8220;</span> | grep POST | grep image | wc -l</div>
</div>
<p>Filtering:</p>
<div class="codesnip-container" >
<div class="codesnip"><span class="co1"># spit out all respone times of HTTP 200 status</span><br />
<span class="co1"># response time is whitespace-separated on 10th position</span><br />
grep <span class="st0">&#8221; 200 &#8220;</span> log-file | awk <span class="st0">&#8216;{print $10}&#8217;</span></p>
<p><span class="co1"># show number of&nbsp; unique called URLs (stand on 7th position)</span><br />
cat log-file | awk <span class="st0">&#8216;{print $7}&#8217;</span> | uniq</p>
<p><span class="co1"># show slowest response time</span><br />
grep <span class="st0">&#8221; 200 &#8220;</span> log-file | awk <span class="st0">&#8216;{print $10}&#8217;</span> | sort -n | tail -n1<br />
<span class="co1"># show fastest response time</span><br />
grep <span class="st0">&#8221; 200 &#8220;</span> log-file | awk <span class="st0">&#8216;{print $10}&#8217;</span> | sort -n | head -n1</p>
<p><span class="co1"># filter lines &#8216;from,to&#8217; (e.g. analyse critical time section)</span><br />
cat log-file | sed -n <span class="st0">&#8216;20,30&#8242;</span></div>
</div>
<p>Transformations:</p>
<div class="codesnip-container" >
<div class="codesnip"><span class="co1"># chain response times with &#8216;,&#8217; instead of linebreaks &#8216;\n&#8217;</span><br />
grep <span class="st0">&#8221; 200 &#8220;</span> log-file | awk <span class="st0">&#8216;{print $10}&#8217;</span> | tr -d <span class="st0">&#8220;<span class="es0">\n</span>&#8220;</span> <span class="st0">&#8220;,&#8221;</span></p>
<p><span class="co1"># delete/omit lines 10-20</span><br />
cat log-file | awk <span class="st0">&#8216;{print $10}&#8217;</span> | sed <span class="st0">&#8216;20,30d&#8217;</span><br />
<span class="co1"># slightly shorter</span><br />
awk <span class="st0">&#8216;{print $10}&#8217;</span> &lt;&nbsp; log-file | sed <span class="st0">&#8216;20,30d&#8217;</span></div>
</div>
<p>Side-Note: While running adhoc log-files queries, often it is enough to go the pragmatic way, e.g. above I used the &#8221; 404 &#8221; in grep command which is not correct (404 could occur inside the response time part also). Never the less it is quicker and shorter to write and collision is unlikely.</p>
<h3>Server farm approach (horizontal scaled)</h3>
<p>How do you run log-analysis in server-farm environments (lots of machines are used to scale up horizontally)? In this situation logs are distributed around on each machine&#8217;s log directory. An option here  is to have a dedicated more storage focused server which runs a batch/cron-job over night copying all the server logs to a single place. This of course is practicable if the files aren&#8217;t too huge and can be processed in reasonable time by single script. If this is not the case you may want to use a more scalable sophisticated solution (like MapReduce with Hadoop). Another alternative is to analyse log on single machine and extrapolate. Most likely you use a load-balancer which causes the traffic to be distributed equally on each machine, i.e. running the same log-query on each machine would give back similar results. The big advantage of the single machine is simplicity: no infrastructure necessary (terminal and log-file sufficient), commands are simple one-liners and speed (only one machine log-file needs to be analysed).</p>
<h3>Summary</h3>
<p>The CLI triangle (bash, its utilities, piping) form a very convenient  ad-hoc query-interface for logs. At first glance they look a bit cryptic, but you get used to it very quickly. Also you already achieve a lot by only knowing a small subset of functionality (e.g. I use only a minimum subset of &#8216;awk&#8217; and &#8217;sed&#8217;). </p>
<p>Am happy about any comments/hints of other lightweight tooling for log-analysis.</p>
<!-- Social Buttons Shared Counts Generated by Digg Digg plugin v4.2, 
    Author : Yong Mook Kim
    Website : http://www.mkyong.com/blog/digg-digg-wordpress-plugin/ -->							</div>
			<p class="tagged"><strong>Tags:</strong> <a href="../../../../category/uncategorized/index.html" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a></p>
		
			<div class="newer_older">		
	<div class="newer">&lt; <a href="../../../05/15/embracing-failure-softwareapproaches/index.html">&#8216;Embrace Failure&#8217; approaches in Software Development</a> </div>
	<div class="older"> <a href="../../../02/06/major-unit-testing-pitfalls-and-anti-patterns/index.html">Unit-Testing: Situations when NOT to do it</a> &gt; </div>
</div>
	
	
			
<!-- You can start editing here. -->


<div id="comments">

	<h3 class="comments_headers">0 responses</h3>
	
	<ul id="comment_list">

	
	<!-- Comment Form -->
		
			
			<p class="unstyled">You must <a href="../../../../wp-login.php@redirect_to=http%253A%252F%252Fwww.aldana-online.de%252F2011%252F03%252F13%252Ftop-tools-for-logging-analysis-cli-based%252F.html">log in</a> to post a comment.</p>
	
		
</div> <!-- Close #comments container -->
<div class="clear flat"></div>
			
				
		</div>
		

			
	</div>

	<div id="footer">
	
  
  <p>	 
    &copy; 2007&ndash;2010 Software Engineering blog &amp; .more  &mdash; <a href="../../../../sitemap.xml">Sitemap</a> &mdash; Manuel Aldana
		      
  </p>
  <p>
			<a href="http://www.mozilla.org/products/firefox/" target="_blank" title="Get Firefox"><img src="../../../../getfirefox_small.png"  border="0" alt="Get Firefox" /></a>  
</p>
  
	</div>
</div>

</body>
</html>
